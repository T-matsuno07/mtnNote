# Git ブランチ系操作まとめ

## トップリポジトリから下位階層のリポジトリまでトラッキングさせる

### トップリポジトリで新しいブランチを作る

`` git branch <BRANCH_NAME>``

トップディレクトリで作業用ブランチを着る。  
ブランチ名は，施策名称にするかマスター媒体名称にするかは悩みどろころ。  
チーム内で共有するブランチとなるので分かりやすい名称を付けると良い。

### リモートリポジトリにて新しいブランチが作られていることをローカルリポジトリから確認する

`` git fetch ``  
`` git branch -a``

分散型バージョン管理システムであるGitでは，リモートリポジトリの情報は自動的に取得しない。  
そのため，最初にfetchコマンドを実行することによってリモートの情報をローカルにダウンロードする。  
次に，branchコマンドに「-a」オプションを指定して実行すると，リモートのブランチ情報を確認することができる。

### リモートブランチを同名のブランチをローカルに作成するのと同時に紐付けを実施する

`` git checkout -t origin/<BRANCH_NAME>``

一番使い勝手が良く標準的なコマンド。  
checkoutコマンドに「-i」オプションを付けることによって，リモートブランチと同名のブランチをローカルに作成することができます。  
checkoutコマンドを使用するので，HEADの位置も切り替わります。  

仮に，リモートリポジトリとは別の名称でブランチを作成したい場合は，「-b」オプションを付けることによって，任意の名称を指定することができます。

`` git checkout -b <ANOTHER_NAME> -t origin/<BRANCH_NAME>``

無駄な混乱を避けるため，リモートとローカルではブランチの名称を一致させることを推奨する。  
調査用に一時的なブランチを切りたいときなどに使いたい場合に。

### ローカルブランチがリモートブランチと結びついていることを確認する

``git branch -vv``
ブランチオプションに「-vv」オプションを付けると，ブランチの紐付け情報が合わせて表示される。  
四角括弧[]内の文字列がリモートリポジトリ名称。  
仮に四角括弧が表示されない場合は，紐付けが実施されていない証拠。  
次のコマンドで紐付けを実施することが可能である。

### 既存のローカルブランチをリモートブランチと紐付ける

既にローカルブランチもリモートブランチも存在しているが，  
トラッキング設定(紐付け)されていない場合に使用するコマンド

``git branch -u <リモートブランチ名> <ローカルブランチ名>``

ローカルブランチ名称の指定を省略した場合，カレントブランチがデフォルトで設定される。  
checkoutコマンドとは異なりHEADの位置が変わらない点では使いやすい。

## ローカルリポジトリで作成したブランチをリモートにも反映させる
pushの設定が「simple」の場合，リモートリポジトリにローカルリポジトリと同名のブランチがないとpushすることができません。  
pushの設定は以下のコマンドで確認できます。  
`` git config --global push.default ``  

ローカルブランチでブランチを作成し，それをリモートに反映したい場合，pushに「--set-upstream」とオプションを付けると，リモートリポジトリにブランチを作成すると同時にローカルブランチとのヒモ付を実施することができます。  
`` git push --set-upstream origin <ローカルブランチ> ``

なお，push.defaultがsimpleの場合，単純に「git push」と打つだけで上記のコマンドがエラー文に表示されます。


# memo
チェックアウト…作業するブランチを切り替える

作業するブランチを切り替えるには、チェックアウトという操作を行います。 チェックアウトを行うと、まず移動先のブランチ内の最後のコミットの内容がワークツリーに展開されます。また、チェックアウト後に行ったコミットは、移動後のブランチに対して追加されるようになります。



HEAD…現在使用しているブランチの先頭を指す用語


ブランチを作成するコマンド
$ git branch <branchname>		# ブランチを作成する
$ git checkout <branchname>		# ブランチを切り替える
$ git branch 					# 現在のブランチを確認する


$ git checkout -b <branchname> # ブランチの作成と切り替えを一度にできる

ブランチのマージ
$ git merge <targetbranch>
HEAD(現在のブランチ)の指しているブランチに指定したブランチが取り込まれる。


☆pull☆
pullを実行するとリモートリポジトリの履歴を取得することができます。

master 				← ローカルリポジトリを指す
original master 	←リモートリポジトリを指す

☆fetch☆

pullを実行すると、リモートリポジトリの内容のマージが自動的に行われてしまいます。しかし、単にリモートリポジトリの内容を確認したいだけの時はマージをしたくない場合もあります。そのような時はfetchを使用します。
実は、pullというのは内部でfetch + mergeをしているからです。


Git リモートリポジトリ 関連
push アップロード
fetch ダウンドード(リモートから更新情報を取得するだけ)
merge リモートローカルのブランチを合流(リモートの更新情報をローカルに反映)
rebase リモートローカルのブランチを合流(リモートの更新情報をローカルに反映)
